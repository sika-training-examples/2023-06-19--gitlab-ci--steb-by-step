# .gitlab-ci.yml

image: golang:1.19

stages:
  - build
  - test

build:
  stage: build
  parallel:
    matrix:
      - GOOS:
          - linux
          - darwin
          - windows
        GOARCH:
          - amd64
          - arm64
      - GOOS:
          - linux
        GOARCH:
          - x86
  artifacts:
    paths:
      - hello-${GOOS}-${GOARCH}
  script:
    - go build -o hello-${GOOS}-${GOARCH} main.go

test:
  stage: test
  script:
    - ./hello-linux-amd64

test32:
  stage: test
  script:
    - ./hello-linux-x86